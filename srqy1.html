<!doctype html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

	<link href="/bootstrap-3.3.7/css/bootstrap.min.css" rel="stylesheet" />
	<link href="/vitalets-bootstrap-datepicker/css/datepicker.css" rel="stylesheet" />
	<link href="/pure-release-1.0.0/pure-min.css" rel="stylesheet" />

	
	<link href="/bootstrap3-editable-1.5.1/bootstrap3-editable/css/bootstrap-editable.css" rel="stylesheet" />
	<link href="/bootstrap-table/bootstrap-table.min.css" rel="stylesheet" />



	<script src="/js/jquery-3.3.1.min.js"></script>
	<script src="/bootstrap-3.3.7/js/bootstrap.min.js"></script> 
	<script src="/vitalets-bootstrap-datepicker/js/bootstrap-datepicker.js" type="text/javascript"></script> 
    <script src="/bootstrap-datepicker/locales/bootstrap-datepicker.zh-CN.min.js" type="text/javascript"></script>
   
   	<script src="/bootstrap3-editable-1.5.1/bootstrap3-editable/js/bootstrap-editable.js"></script>
	<script src="/bootstrap-table/bootstrap-table.js"></script>
	<script src="/bootstrap-table/locale/bootstrap-table-zh-CN.js"></script>
	<script src="/bootstrap-table/extensions/editable/bootstrap-table-editable.js"></script>
	
	<script src="/js/commonfun.js"></script>
	
   <title>Hello, world!</title>
   
  </head>
  
  <body>


<div style="padding: 20px 80px 10px;">
    
        <div class="row"> 
		<div class="span12">
			<div class="tabbable" id="tabs-974021">
				<ul class="nav nav-tabs">
					<li>
						<a href="#panel-21660" data-toggle="tab">基本信息</a>
					</li>
					<li class="active">
						<a href="#panel-86038" data-toggle="tab">储量</a>
					</li>
				</ul>
				<div class="tab-content">
					<div class="tab-pane" id="panel-21660">
						<p>
							<div class="col-lg-3">
								<div  class="form-inline"> 
								 <label>评估日期:</label>
									<div class="input-group date" id="ws" >

										<input type="text" id="ww" class="form-control"  readonly>
										<span class="input-group-addon"><i class="glyphicon glyphicon-calendar"></i>
										</span>
									</div>
								</div>
								
								<p/>

								<div class="col-lg-14">
									<fieldset class="scheduler-border">
										<legend ><h5>五年生产规模</h5></legend>
										
										<div class=" input-group">
											<span class="input-group-addon">第一年：</span>
											<input type="text" class="form-control" />
										</div>
										<p/>
										<div class=" input-group">
											<span class="input-group-addon">第二年：</span>
											<input type="text" class="form-control" />
										</div>
										<p/>
										
										<div class=" input-group">
											<span class="input-group-addon">第三年：</span>
											<input type="text" class="form-control" />
										</div>
										<p/>
										
										<div class=" input-group">
											<span class="input-group-addon">第四年：</span>
											<input type="text" class="form-control" />
										</div>
										<p/>
										
										<div class=" input-group">
											<span class="input-group-addon">第五年：</span>
											<input type="text" class="form-control" />
										</div>
										
										
									</fieldset>
								</div>
								
							</div>
				
						</p>
					</div>
					<div class="tab-pane active" id="panel-86038">
						<p>
						<div class="container">
							<div id="toolbar">
								<button id="btncal" class="btn btn-sm btn-primary">
									<i class="glyphicon glyphicon-send"></i> 计算
								</button>
								
								<button id="btnadd" class="btn  btn-sm btn-success">
									<i class="glyphicon glyphicon-plus"></i> 添加
								</button>
								
								<button id="btndel" class="btn btn-sm btn-warning">
									<i class="glyphicon glyphicon-minus"></i> 删除
								</button>
							</div>
	<!-- <button type="button" class="btn btn-success">刷新</button> -->
        <table id="table" class="table table-striped table-bordered table-hover">
        <thead>
            <tr>
                <th data-field="fc">1</th>
                <th data-field="sc">2</th>
                <th data-field="gcl">3</th>
				<th data-field="dwys">4</th>
                <th data-field="tzxs">5</th>
                
            </tr>
        </thead>
    </table>

    </div>
						</p>
					</div>
				</div>
			</div>
			
		</div>
		 
		    
            
   
</div>




    
	    
</body>
</html>

<script>
//日历初始化
$('#ww').datepicker({
    format: 'yyyy-mm-dd',
    language: "zh-CN",
    autoclose:true,
    startView: 1,
    minViewMode: 'month',
    maxViewMode:'month'
}
);



//表格初始化
var $table = $('#table');
var index=0;


var listJson = [];
/*var contentFC = ["地形测绘", "地质测量", "遥感地质", "物探", "化探", "钻探", "山地工程", "岩矿测试"];
var indexarray = [0, 2, 8, 10, 16, 24, 29, 32];
var contentSC = ["地形测量", "制图", //2
	"区域地质调查", "专项地质测量", "区域水文地质、生态环境地质调查",
	"专项水文地质、生态环境地质测量",
	"区域工程地质、环境地质调查",
	"专项工程地质、环境地质、地质灾害测量", //8

	"航空遥感彩色摄影", "遥感地质解译", //10
	"磁法", "重力", "电法", "地震", "放射性", "侧井", //15
	"土壤测量", "岩石测量", "水地球化学测量", "水系沉积物测量", "汞气测量", "地气测量", "地热化探测量", "航空物探", //23
	"矿产地质钻探", "水文地质钻探", "地热钻探", "工程地质钻探", "原位测试", //28
	"坑探", "浅井", "槽探", //31
	"岩矿分析", "化探分析", "土壤分析", "水质分析", "光谱半定量分析", "非金属矿物性测试", "煤质分析", "岩矿鉴定与实验", "选冶实验"];

var index = 0; //标注总的合并的
var index_input = 0;
for (i = 0; i < contentSC.length; i++) {
	var jsonTemp = {};

	if (in_array(i, indexarray) == true) {
		jsonTemp.fc = contentFC[index];
		index++;
	} else
		jsonTemp.fc = "";

	jsonTemp.sc=contentSC[i];
	
	jsonTemp.gcl=0;
	jsonTemp.dwys=1;
	jsonTemp.tzxs=1;
	jsonTemp.dqtzxs=1;
	
	listJson.push(jsonTemp);
	　　
}*/

//聚合数据发送到链接


function in_array(search, array) {
	for (var i in array) {
		if (array[i] == search) {
			return true;
		}
	}
	return false;
};

$(function () {
	$('#table').bootstrapTable({
		data: listJson,
		toolbar: "#toolbar",
		idField: "sc",
		pagination: true,
		showRefresh: true,
		search: true,
		clickToSelect: true,
		columns: [
					[
						{
							title: '选择',
							//field: 'idcheck',
							field : 'checked',
							checkbox: true,
							align: 'center',
							valign: 'middle',
							colspan: 1,
							rowspan: 2,
							clickToSelect:true
						},
						
						
						
						{
							title: '保有资源量',
							field: '',
							align: 'center',
							valign: 'middle',
							colspan: 3,
							rowspan: 1
						},
						
						{
							title: '可信度系数',
							field: '',
							align: 'center',
							valign: 'middle',
							colspan: 3,
							rowspan: 1
						},
						
						
						{
							title: '设计损失量',
							field: '',
							align: 'center',
							valign: 'middle',
							colspan: 1,
							rowspan: 1
						},
						
						{
							title: '非永久矿柱',
							field: '',
							align: 'center',
							valign: 'middle',
							colspan: 2,
							rowspan: 1
						},
						
						{
							title: '采矿回采率',
							field: '',
							align: 'center',
							valign: 'middle',
							colspan: 2,
							rowspan: 1
						},
						
						{
							title: '储量备用系数',
							field: 'clbyxs',
							align: 'center',
							valign: 'middle',
							colspan: 1,
							rowspan: 2,
							editable: {
								type: 'text',
								mode: 'inline',
								validate: function (v) {
									if (!v)
										return '不能为空';

								}
							}
						},
						
					],
					
					[
						{
							field: "b11332",
							title: "1...332",
							align: "center",
							//order: "asc",
							//sortable: "true",
							editable: {
								type: 'text',
								mode: 'inline',
								validate: function (v) {
									if (!v)
										return '不能为空';

								}
							}
						},
						
						{
							field: "b333",
							title: "333",
							align: "center",
							//order: "asc",
							//sortable: "true",
							editable: {
								type: 'text',
								mode: 'inline',
								validate: function (v) {
									if (!v)
										return '不能为空';

								}
							}
						},
						
						{
							field: "b2334",
							title: "2...334",
							align: "center",
							//order: "asc",
							//sortable: "true",
							editable: {
								type: 'text',
								mode: 'inline',
								validate: function (v) {
									if (!v)
										return '不能为空';

								}
							}
						},
						
						
						{
							field: "b11332xs",
							title: "1...332",
							align: "center",
							//order: "asc",
							//sortable: "true",
							editable: {
								type: 'text',
								mode: 'inline',
								validate: function (v) {
									if (!v)
										return '不能为空';

								}
							}
						},
						
						{
							field: "b333xs",
							title: "333",
							align: "center",
							//order: "asc",
							//sortable: "true",
							editable: {
								type: 'text',
								mode: 'inline',
								validate: function (v) {
									if (!v)
										return '不能为空';

								}
							}
						},
						
						{
							field: "b2334xs",
							title: "2...334",
							align: "center",
							//order: "asc",
							//sortable: "true",
							editable: {
								type: 'text',
								mode: 'inline',
								validate: function (v) {
									if (!v)
										return '不能为空';

								}
							}
						},
						
						{
							field: "yjkz",
							title: "永久矿柱",
							align: "center",
							//order: "asc",
							//sortable: "true",
							editable: {
								type: 'text',
								mode: 'inline',
								validate: function (v) {
									if (!v)
										return '不能为空';

								}
							}
						},
						
						{
							field: "lskz",
							title: "临时矿柱",
							align: "center",
							//order: "asc",
							sortable: "true",
							editable: {
								type: 'text',
								mode: 'inline',
								validate: function (v) {
									if (!v)
										return '不能为空';

								}
							}
						},
						
						{
							field: "sxyk",
							title: "三下压矿",
							align: "center",
							//order: "asc",
							sortable: "true",
							editable: {
								type: 'text',
								mode: 'inline',
								validate: function (v) {
									if (!v)
										return '不能为空';

								}
							}
						},
						
						{
							field: "cqhcl",
							title: "采区回采率",
							align: "center",
							//order: "asc",
							//sortable: "true",
							editable: {
								type: 'text',
								mode: 'inline',
								validate: function (v) {
									if (!v)
										return '不能为空';

								}
							}
						},
						
						{
							field: "fjykzhcl",
							title: "非永久矿柱回采率",
							align: "center",
							//order: "asc",
							sortable: "true",
							editable: {
								type: 'text',
								mode: 'inline',
								validate: function (v) {
									if (!v)
										return '不能为空';

								}
							}
						}
						
						
					
					
					
					
					]
					
					
		]

	});
},


$("#btnadd").click(
	function()
			{
				row=chuliangmeirow(index);
				$table.bootstrapTable('insertRow', {index: index++, row: row})
			}
),

$("#btndel").click(
	function()
			{
				var rows= $table.bootstrapTable('getSelections');
				var rowsid=[]
				for(i=0;i<rows.length;i++)
					rowsid.push(rows[i].id);
				$table.bootstrapTable('remove', {field: 'id', values: rowsid})
			}
),

$("#btncal").click(
	function()
			{
			
				var allTableData = $table.bootstrapTable('getData');
				
				//for( j=0;j<allTableData

				result1=chuliangmeitable(allTableData);
				
					
				$.getJSON('http://127.0.0.1:5000/mrm/api/kccbxy/', 
					//{U:'[1,2,3,4]',P:'[1,2,3,4]',AdCoeff:'[1,0.5,0.5,0.5]',AdCoeffA:'[1,1,1,1]',epsilon:0.3,F:'[[1,1,1,1],[1,1,1,1]]'},
					{U:JSON.stringify(result1[0]),P:JSON.stringify(result1[1]),AdCoeff:JSON.stringify(result1[2]),AdCoeffA:JSON.stringify(result1[3]),epsilon:0.3,F:JSON.stringify(xsF)},
					function(data) {
					if(data.result!="-1")
					{
						alert('评估价值：'+data.result);
					}
					else
					{
						alert('参数错误！');
					}
					
				  });
				  return false;
				
			}
),
  



);











</script>

  </body>
</html>